id: c.lang.security.insecure-use-strtok-fn.insecure-use-strtok-fn
pattern: strtok(...)
message: Avoid using 'strtok()'. This function directly modifies the first argument
  buffer, permanently erasing the delimiter character. Use 'strtok_r()' instead.
metadata:
  cwe:
  - 'CWE-676: Use of Potentially Dangerous Function'
  references:
  - https://wiki.sei.cmu.edu/confluence/display/c/STR06-C.+Do+not+assume+that+strtok%28%29+leaves+the+parse+string+unchanged
  - https://man7.org/linux/man-pages/man3/strtok.3.html#BUGS
  - https://stackoverflow.com/a/40335556
  category: security
  technology:
  - c
  confidence: LOW
  subcategory:
  - audit
  likelihood: LOW
  impact: HIGH
  license: Commons Clause License Condition v1.0[LGPL-2.1-only]
  vulnerability_class:
  - Dangerous Method or Function
  source: https://semgrep.dev/r/c.lang.security.insecure-use-strtok-fn.insecure-use-strtok-fn
  shortlink: https://sg.run/LwqG
  semgrep.dev:
    rule:
      r_id: 8839
      rv_id: 109014
      rule_id: WAUo5v
      version_id: ExTjNA3
      url: https://semgrep.dev/playground/r/ExTjNA3/c.lang.security.insecure-use-strtok-fn.insecure-use-strtok-fn
      origin: community
languages:
- c
severity: WARNING
