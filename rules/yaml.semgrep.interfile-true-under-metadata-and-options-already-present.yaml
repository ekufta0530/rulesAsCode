id: yaml.semgrep.interfile-true-under-metadata-and-options-already-present.interfile-true-under-metadata-and-options-already-present
message: '`interfile: true` should be under the `options` field, not the `metadata`
  field.'
languages:
- yaml
severity: WARNING
patterns:
- pattern: "rules:\n  - id: $ID\n    ...\n    $METADATA:\n      ...\n      $INTERFILE:\
    \ true\n      ...\n    ...\n"
- pattern-inside: "rules:\n  - id: $ID\n    ...\n    $OPTIONS:\n      $FIRST_OPT:\
    \ $VAL\n      ...\n    ...\n"
- pattern-not-inside: "rules:\n  - id: $ID\n    ...\n    $OPTIONS:\n      ...\n  \
    \    interfile: true\n      ...\n    ...\n"
- metavariable-regex:
    metavariable: $INTERFILE
    regex: interfile
- metavariable-regex:
    metavariable: $METADATA
    regex: metadata
- metavariable-regex:
    metavariable: $OPTIONS
    regex: options
- focus-metavariable: $FIRST_OPT
fix: 'interfile: true

  $FIRST_OPT

  '
metadata:
  license: Commons Clause License Condition v1.0[LGPL-2.1-only]
  source: https://semgrep.dev/r/yaml.semgrep.interfile-true-under-metadata-and-options-already-present.interfile-true-under-metadata-and-options-already-present
  shortlink: https://sg.run/gQK5
  semgrep.dev:
    rule:
      r_id: 70985
      rv_id: 255681
      rule_id: 8GUrXy
      version_id: DkT9dqQ
      url: https://semgrep.dev/playground/r/DkT9dqQ/yaml.semgrep.interfile-true-under-metadata-and-options-already-present.interfile-true-under-metadata-and-options-already-present
      origin: community
