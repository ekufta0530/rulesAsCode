id: python.flask.db.peewee-flask.peewee-flask
message: Untrusted input might be used to build a database query, which can lead to
  a SQL injection vulnerability. An attacker can execute malicious SQL statements
  and gain unauthorized access to sensitive data, modify, delete data, or execute
  arbitrary system commands. Peewee provides a query builder which should allow to
  create the SQL query in a safe way. If you cannot use it, make sure to check the
  value exists in an allowlist, such that no user-controllable value can influence
  the eventual SQL query.
severity: ERROR
metadata:
  likelihood: HIGH
  impact: HIGH
  confidence: HIGH
  category: security
  subcategory:
  - vuln
  cwe:
  - 'CWE-89: Improper Neutralization of Special Elements used in an SQL Command (''SQL
    Injection'')'
  cwe2020-top25: true
  cwe2021-top25: true
  cwe2022-top25: true
  functional-categories:
  - db::sink::sql-or-nosql-query::peewee
  - web::source::cookie::flask
  - web::source::form-data::flask
  - web::source::form-data::flask-wtf
  - web::source::form-data::wtforms
  - web::source::header::flask
  - web::source::http-body::flask
  - web::source::http-params::flask
  - web::source::url-path-params::flask
  owasp:
  - A01:2017 - Injection
  - A03:2021 - Injection
  references:
  - https://owasp.org/Top10/A03_2021-Injection
  technology:
  - flask
  - flask-wtf
  - peewee
  - sql
  - web
  - wtforms
  license: Copyright 2023 Semgrep, Inc.
  vulnerability_class:
  - SQL Injection
  source: https://semgrep.dev/r/python.flask.db.peewee-flask.peewee-flask
  shortlink: https://sg.run/BYq6v
  semgrep.dev:
    rule:
      r_id: 116507
      rv_id: 524325
      rule_id: KxUvg7d
      version_id: nWTrrLd
      url: https://semgrep.dev/playground/r/nWTrrLd/python.flask.db.peewee-flask.peewee-flask
      origin: pro_rules
languages:
- python
mode: taint
options:
  interfile: true
  symbolic_propagation: true
  taint_assume_safe_booleans: true
  taint_assume_safe_numbers: true
pattern-sources:
- pattern-either:
  - patterns:
    - pattern: flask.request.$FUNC()
    - metavariable-regex:
        metavariable: $FUNC
        regex: ^(from_values|get_data|get_json)$
  - patterns:
    - pattern-either:
      - pattern: flask.request.$PROPERTY
      - pattern: flask.request.$PROPERTY[...]
      - pattern: flask.request.$PROPERTY.get(...)
    - metavariable-regex:
        metavariable: $PROPERTY
        regex: ^(args|cookies|data|files|form|full_path|headers|input_stream|json|path|stream|values|view_args)$
  - patterns:
    - pattern: "@$APP.$ROUTE\ndef $FUNC(..., $PARAM, ...):\n  ...\n"
    - metavariable-regex:
        metavariable: $ROUTE
        regex: ^(endpoint)$
    - focus-metavariable: $PARAM
- patterns:
  - pattern: "@$APP.$ROUTE(...)\ndef $FUNC(..., $PARAM, ...):\n  ...\n"
  - metavariable-regex:
      metavariable: $ROUTE
      regex: ^(route|delete|get|patch|post|put)$
  - focus-metavariable: $PARAM
- patterns:
  - pattern-either:
    - pattern-inside: "@$APP.$ROUTE(...)\ndef $FUNC(...):\n  ...\n  $FORM = $FORMCLASS(...)\n\
        \  ...\n  $FORM.validate_on_submit()\n  ...\n"
    - pattern-inside: "@$APP.$ROUTE(...)\ndef $FUNC(...):\n  ...\n  $FORM = $FORMCLASS(...)\n\
        \  ...\n  if $FORM.validate_on_submit():\n    ...\n  ...\n"
  - metavariable-regex:
      metavariable: $ROUTE
      regex: ^(route|delete|get|patch|post|put|endpoint)$
  - pattern: $FORM.$FIELD.data
pattern-propagators:
- from: $DEFAULT
  patterns:
  - patterns:
    - pattern-either:
      - pattern-inside: '$DICT[$KEY]

          ...

          '
      - pattern-inside: '$DICT.get($KEY, $DEFAULT)

          ...

          '
      - pattern-inside: '$DICT = { ... }

          ...

          '
      - pattern-inside: '$DICT = dict(...)

          ...

          '
    - pattern-either:
      - pattern: $DICT.get($FIELD, $DEFAULT)
      - pattern: $DICT.setdefault($KEY, $DEFAULT)
  to: $DICT
- from: $FROM_DICT
  patterns:
  - patterns:
    - pattern-either:
      - pattern-inside: '$TO_DICT[$KEY]

          ...

          '
      - pattern-inside: '$TO_DICT.get($KEY, $DEFAULT)

          ...

          '
      - pattern-inside: '$TO_DICT = { ... }

          ...

          '
      - pattern-inside: '$TO_DICT = dict(...)

          ...

          '
      - pattern-inside: '$FROM_DICT[$KEY]

          ...

          '
      - pattern-inside: '$FROM_DICT.get($KEY, $DEFAULT)

          ...

          '
      - pattern-inside: '$FROM_DICT = { ... }

          ...

          '
      - pattern-inside: '$FROM_DICT = dict(...)

          ...

          '
    - pattern-either:
      - pattern: $TO_DICT.update($FROM_DICT)
      - pattern: $TO_DICT | $FROM_DICT
      - pattern: $TO_DICT |= $FROM_DICT
  to: $TO_DICT
- from: $FROM
  patterns:
  - patterns:
    - pattern-either:
      - pattern-inside: '$LIST = [ ... ]

          ...

          '
      - pattern-inside: '$LIST = list(...)

          ...

          '
    - pattern-either:
      - pattern: $LIST.append($FROM)
      - pattern: $LIST.extend($FROM)
      - pattern: $LIST.insert($INDEX, $FROM)
  to: $LIST
- from: $FROM
  patterns:
  - patterns:
    - pattern-either:
      - pattern-inside: '$SET = { $ITEM, ... }

          ...

          '
      - pattern-inside: '$SET = set(...)

          ...

          '
      - pattern-inside: '$OTHERSET = { $ITEM, ... }

          ...

          '
      - pattern-inside: '$OTHERSET = set(...)

          ...

          '
    - pattern-either:
      - pattern: $SET.update(..., $FROM, ...)
      - pattern: $SET.intersection_update(..., $FROM, ...)
      - pattern: $SET.difference_update(..., $FROM, ...)
      - pattern: $SET.symmetric_difference_update(..., $FROM, ...)
      - pattern: $SET.add($FROM)
      - pattern: $SET |= $FROM
      - pattern: $SET &= $FROM
      - pattern: $SET -= $FROM
      - pattern: $SET ^= $FROM
  to: $SET
- from: $FORM
  patterns:
  - pattern: $FORM.populate_obj($OBJ)
  to: $OBJ
pattern-sinks:
- patterns:
  - pattern-either:
    - patterns:
      - pattern-either:
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.Database\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.Database = ...\n  ...\n"
        - pattern-inside: "class $DB(..., peewee.Database, ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: peewee.Database, ...):\n  ...\n"
        - pattern-inside: '$DB: peewee.Database

            ...

            '
        - pattern-inside: '$DB: peewee.Database = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, peewee.Database):\n  ...\n"
        - pattern-inside: "if isinstance($DB, (..., peewee.Database, ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == peewee.Database:\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.SqliteDatabase\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.SqliteDatabase = ...\n\
            \  ...\n"
        - pattern-inside: "class $DB(..., peewee.SqliteDatabase, ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: peewee.SqliteDatabase, ...):\n  ...\n"
        - pattern-inside: '$DB: peewee.SqliteDatabase

            ...

            '
        - pattern-inside: '$DB: peewee.SqliteDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, peewee.SqliteDatabase):\n  ...\n"
        - pattern-inside: "if isinstance($DB, (..., peewee.SqliteDatabase, ...)):\n\
            \  ...\n"
        - pattern-inside: "if type($DB) == peewee.SqliteDatabase:\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.PostgresqlDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.PostgresqlDatabase =\
            \ ...\n  ...\n"
        - pattern-inside: "class $DB(..., peewee.PostgresqlDatabase, ...):\n  ...\n\
            ...\n"
        - pattern-inside: "def $FUN(..., $DB: peewee.PostgresqlDatabase, ...):\n \
            \ ...\n"
        - pattern-inside: '$DB: peewee.PostgresqlDatabase

            ...

            '
        - pattern-inside: '$DB: peewee.PostgresqlDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, peewee.PostgresqlDatabase):\n  ...\n"
        - pattern-inside: "if isinstance($DB, (..., peewee.PostgresqlDatabase, ...)):\n\
            \  ...\n"
        - pattern-inside: "if type($DB) == peewee.PostgresqlDatabase:\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.MySQLDatabase\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.MySQLDatabase = ...\n\
            \  ...\n"
        - pattern-inside: "class $DB(..., peewee.MySQLDatabase, ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: peewee.MySQLDatabase, ...):\n  ...\n"
        - pattern-inside: '$DB: peewee.MySQLDatabase

            ...

            '
        - pattern-inside: '$DB: peewee.MySQLDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, peewee.MySQLDatabase):\n  ...\n"
        - pattern-inside: "if isinstance($DB, (..., peewee.MySQLDatabase, ...)):\n\
            \  ...\n"
        - pattern-inside: "if type($DB) == peewee.MySQLDatabase:\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.DatabaseProxy\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.DatabaseProxy = ...\n\
            \  ...\n"
        - pattern-inside: "class $DB(..., peewee.DatabaseProxy, ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: peewee.DatabaseProxy, ...):\n  ...\n"
        - pattern-inside: '$DB: peewee.DatabaseProxy

            ...

            '
        - pattern-inside: '$DB: peewee.DatabaseProxy = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, peewee.DatabaseProxy):\n  ...\n"
        - pattern-inside: "if isinstance($DB, (..., peewee.DatabaseProxy, ...)):\n\
            \  ...\n"
        - pattern-inside: "if type($DB) == peewee.DatabaseProxy:\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.apsw_ext.APSWDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.apsw_ext.APSWDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.apsw_ext.APSWDatabase, ...):\n\
            \  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.apsw_ext.APSWDatabase, ...):\n\
            \  ...\n"
        - pattern-inside: '$DB: playhouse.apsw_ext.APSWDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.apsw_ext.APSWDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.apsw_ext.APSWDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.apsw_ext.APSWDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.apsw_ext.APSWDatabase:\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.cockroachdb.CockroachDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.cockroachdb.CockroachDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.cockroachdb.CockroachDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.cockroachdb.CockroachDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.cockroachdb.CockroachDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.cockroachdb.CockroachDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.cockroachdb.CockroachDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.cockroachdb.CockroachDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.cockroachdb.CockroachDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.mysql_ext.MariaDBConnectorDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.mysql_ext.MariaDBConnectorDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.mysql_ext.MariaDBConnectorDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.mysql_ext.MariaDBConnectorDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.mysql_ext.MariaDBConnectorDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.mysql_ext.MariaDBConnectorDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.mysql_ext.MariaDBConnectorDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.mysql_ext.MariaDBConnectorDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.mysql_ext.MariaDBConnectorDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.mysql_ext.MySQLConnectorDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.mysql_ext.MySQLConnectorDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.mysql_ext.MySQLConnectorDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.mysql_ext.MySQLConnectorDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.mysql_ext.MySQLConnectorDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.mysql_ext.MySQLConnectorDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.mysql_ext.MySQLConnectorDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.mysql_ext.MySQLConnectorDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.mysql_ext.MySQLConnectorDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledMySQLDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledMySQLDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.pool.PooledMySQLDatabase, ...):\n\
            \  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.pool.PooledMySQLDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.pool.PooledMySQLDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.pool.PooledMySQLDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.pool.PooledMySQLDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.pool.PooledMySQLDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.pool.PooledMySQLDatabase:\n \
            \ ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledPostgresqlDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledPostgresqlDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.pool.PooledPostgresqlDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.pool.PooledPostgresqlDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.pool.PooledPostgresqlDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.pool.PooledPostgresqlDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.pool.PooledPostgresqlDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.pool.PooledPostgresqlDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.pool.PooledPostgresqlDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledPostgresqlExtDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledPostgresqlExtDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.pool.PooledPostgresqlExtDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.pool.PooledPostgresqlExtDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.pool.PooledPostgresqlExtDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.pool.PooledPostgresqlExtDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.pool.PooledPostgresqlExtDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.pool.PooledPostgresqlExtDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.pool.PooledPostgresqlExtDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledSqliteDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledSqliteDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.pool.PooledSqliteDatabase, ...):\n\
            \  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.pool.PooledSqliteDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.pool.PooledSqliteDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.pool.PooledSqliteDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.pool.PooledSqliteDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.pool.PooledSqliteDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.pool.PooledSqliteDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledSqliteExtDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledSqliteExtDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.pool.PooledSqliteExtDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.pool.PooledSqliteExtDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.pool.PooledSqliteExtDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.pool.PooledSqliteExtDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.pool.PooledSqliteExtDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.pool.PooledSqliteExtDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.pool.PooledSqliteExtDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.postgres_ext.PostgresqlExtDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.postgres_ext.PostgresqlExtDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.postgres_ext.PostgresqlExtDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.postgres_ext.PostgresqlExtDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.postgres_ext.PostgresqlExtDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.postgres_ext.PostgresqlExtDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.postgres_ext.PostgresqlExtDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.postgres_ext.PostgresqlExtDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.postgres_ext.PostgresqlExtDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.psycopg3_ext.Psycopg3Database\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.psycopg3_ext.Psycopg3Database\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.psycopg3_ext.Psycopg3Database,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.psycopg3_ext.Psycopg3Database,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.psycopg3_ext.Psycopg3Database

            ...

            '
        - pattern-inside: '$DB: playhouse.psycopg3_ext.Psycopg3Database = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.psycopg3_ext.Psycopg3Database):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.psycopg3_ext.Psycopg3Database,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.psycopg3_ext.Psycopg3Database:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlcipher_ext.SqlCipherDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlcipher_ext.SqlCipherDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.sqlcipher_ext.SqlCipherDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.sqlcipher_ext.SqlCipherDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.sqlcipher_ext.SqlCipherDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.sqlcipher_ext.SqlCipherDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.sqlcipher_ext.SqlCipherDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.sqlcipher_ext.SqlCipherDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.sqlcipher_ext.SqlCipherDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.sqlcipher_ext.SqlCipherExtDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.sqlcipher_ext.SqlCipherExtDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.sqlcipher_ext.SqlCipherExtDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.sqlcipher_ext.SqlCipherExtDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlite_ext.CSqliteExtDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlite_ext.CSqliteExtDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.sqlite_ext.CSqliteExtDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.sqlite_ext.CSqliteExtDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.sqlite_ext.CSqliteExtDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.sqlite_ext.CSqliteExtDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.sqlite_ext.CSqliteExtDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.sqlite_ext.CSqliteExtDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.sqlite_ext.CSqliteExtDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlite_ext.SqliteExtDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlite_ext.SqliteExtDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.sqlite_ext.SqliteExtDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.sqlite_ext.SqliteExtDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.sqlite_ext.SqliteExtDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.sqlite_ext.SqliteExtDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.sqlite_ext.SqliteExtDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.sqlite_ext.SqliteExtDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.sqlite_ext.SqliteExtDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqliteq.SqliteQueueDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqliteq.SqliteQueueDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.sqliteq.SqliteQueueDatabase, ...):\n\
            \  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.sqliteq.SqliteQueueDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.sqliteq.SqliteQueueDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.sqliteq.SqliteQueueDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.sqliteq.SqliteQueueDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.sqliteq.SqliteQueueDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.sqliteq.SqliteQueueDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.flask_utils.FlaskDB\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.flask_utils.FlaskDB\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.flask_utils.FlaskDB, ...):\n \
            \ ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.flask_utils.FlaskDB, ...):\n\
            \  ...\n"
        - pattern-inside: '$DB: playhouse.flask_utils.FlaskDB

            ...

            '
        - pattern-inside: '$DB: playhouse.flask_utils.FlaskDB = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.flask_utils.FlaskDB):\n  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.flask_utils.FlaskDB,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.flask_utils.FlaskDB:\n  ...\n"
        - pattern-inside: '$DB = peewee.Database(...)

            ...

            '
        - pattern-inside: '$DB = peewee.SqliteDatabase(...)

            ...

            '
        - pattern-inside: '$DB = peewee.PostgresqlDatabase(...)

            ...

            '
        - pattern-inside: '$DB = peewee.MySQLDatabase(...)

            ...

            '
        - pattern-inside: '$DB = peewee.DatabaseProxy(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.apsw_ext.APSWDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.cockroachdb.CockroachDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.mysql_ext.MariaDBConnectorDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.mysql_ext.MySQLConnectorDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.pool.PooledMySQLDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.pool.PooledPostgresqlDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.pool.PooledPostgresqlExtDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.pool.PooledSqliteDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.pool.PooledSqliteExtDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.postgres_ext.PostgresqlExtDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.psycopg3_ext.Psycopg3Database(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.sqlcipher_ext.SqlCipherDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.sqlcipher_ext.SqlCipherExtDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.sqlite_ext.CSqliteExtDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.sqlite_ext.SqliteExtDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.sqliteq.SqliteQueueDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.flask_utils.FlaskDB(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.connect(...)

            ...

            '
      - pattern-either:
        - patterns:
          - pattern-either:
            - pattern: $DB.execute_sql($SINK, ...)
            - pattern: $DB.execute_sql(..., sql=$SINK, ...)
            - pattern: $DB.cursor().execute($SINK, ...)
            - pattern: $DB.cursor().execute(..., query=$SINK, ...)
            - pattern: $DB.cursor().executemany($SINK, ...)
            - pattern: $DB.cursor().executemany(..., query=$SINK, ...)
    - patterns:
      - pattern-either:
        - pattern-inside: "class $CLS:\n  ...\n  $FLASK_DB: playhouse.flask_utils.FlaskDB\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $FLASK_DB: playhouse.flask_utils.FlaskDB\
            \ = ...\n  ...\n"
        - pattern-inside: "class $FLASK_DB(..., playhouse.flask_utils.FlaskDB, ...):\n\
            \  ...\n...\n"
        - pattern-inside: "def $FUN(..., $FLASK_DB: playhouse.flask_utils.FlaskDB,\
            \ ...):\n  ...\n"
        - pattern-inside: '$FLASK_DB: playhouse.flask_utils.FlaskDB

            ...

            '
        - pattern-inside: '$FLASK_DB: playhouse.flask_utils.FlaskDB = ...

            ...

            '
        - pattern-inside: "if isinstance($FLASK_DB, playhouse.flask_utils.FlaskDB):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($FLASK_DB, (..., playhouse.flask_utils.FlaskDB,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($FLASK_DB) == playhouse.flask_utils.FlaskDB:\n\
            \  ...\n"
        - pattern-inside: '$FLASK_DB = playhouse.flask_utils.FlaskDB(...)

            ...

            '
        - pattern-inside: '$FLASK_DB = playhouse.flask_utils.FlaskDB(...)

            ...

            '
      - pattern-either:
        - patterns:
          - pattern-either:
            - pattern: $FLASK_DB.database.execute_sql($SINK, ...)
            - pattern: $FLASK_DB.database.execute_sql(..., sql=$SINK, ...)
            - pattern: $FLASK_DB.database.cursor().execute($SINK, ...)
            - pattern: $FLASK_DB.database.cursor().execute(..., query=$SINK, ...)
            - pattern: $DFLASK_DB.database.cursor().executemany($SINK, ...)
            - pattern: $DFLASK_DB.database.cursor().executemany(..., query=$SINK,
                ...)
    - patterns:
      - pattern-either:
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.Database\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.Database = ...\n  ...\n"
        - pattern-inside: "class $DB(..., peewee.Database, ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: peewee.Database, ...):\n  ...\n"
        - pattern-inside: '$DB: peewee.Database

            ...

            '
        - pattern-inside: '$DB: peewee.Database = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, peewee.Database):\n  ...\n"
        - pattern-inside: "if isinstance($DB, (..., peewee.Database, ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == peewee.Database:\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.SqliteDatabase\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.SqliteDatabase = ...\n\
            \  ...\n"
        - pattern-inside: "class $DB(..., peewee.SqliteDatabase, ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: peewee.SqliteDatabase, ...):\n  ...\n"
        - pattern-inside: '$DB: peewee.SqliteDatabase

            ...

            '
        - pattern-inside: '$DB: peewee.SqliteDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, peewee.SqliteDatabase):\n  ...\n"
        - pattern-inside: "if isinstance($DB, (..., peewee.SqliteDatabase, ...)):\n\
            \  ...\n"
        - pattern-inside: "if type($DB) == peewee.SqliteDatabase:\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.PostgresqlDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.PostgresqlDatabase =\
            \ ...\n  ...\n"
        - pattern-inside: "class $DB(..., peewee.PostgresqlDatabase, ...):\n  ...\n\
            ...\n"
        - pattern-inside: "def $FUN(..., $DB: peewee.PostgresqlDatabase, ...):\n \
            \ ...\n"
        - pattern-inside: '$DB: peewee.PostgresqlDatabase

            ...

            '
        - pattern-inside: '$DB: peewee.PostgresqlDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, peewee.PostgresqlDatabase):\n  ...\n"
        - pattern-inside: "if isinstance($DB, (..., peewee.PostgresqlDatabase, ...)):\n\
            \  ...\n"
        - pattern-inside: "if type($DB) == peewee.PostgresqlDatabase:\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.MySQLDatabase\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.MySQLDatabase = ...\n\
            \  ...\n"
        - pattern-inside: "class $DB(..., peewee.MySQLDatabase, ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: peewee.MySQLDatabase, ...):\n  ...\n"
        - pattern-inside: '$DB: peewee.MySQLDatabase

            ...

            '
        - pattern-inside: '$DB: peewee.MySQLDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, peewee.MySQLDatabase):\n  ...\n"
        - pattern-inside: "if isinstance($DB, (..., peewee.MySQLDatabase, ...)):\n\
            \  ...\n"
        - pattern-inside: "if type($DB) == peewee.MySQLDatabase:\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.DatabaseProxy\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: peewee.DatabaseProxy = ...\n\
            \  ...\n"
        - pattern-inside: "class $DB(..., peewee.DatabaseProxy, ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: peewee.DatabaseProxy, ...):\n  ...\n"
        - pattern-inside: '$DB: peewee.DatabaseProxy

            ...

            '
        - pattern-inside: '$DB: peewee.DatabaseProxy = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, peewee.DatabaseProxy):\n  ...\n"
        - pattern-inside: "if isinstance($DB, (..., peewee.DatabaseProxy, ...)):\n\
            \  ...\n"
        - pattern-inside: "if type($DB) == peewee.DatabaseProxy:\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.apsw_ext.APSWDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.apsw_ext.APSWDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.apsw_ext.APSWDatabase, ...):\n\
            \  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.apsw_ext.APSWDatabase, ...):\n\
            \  ...\n"
        - pattern-inside: '$DB: playhouse.apsw_ext.APSWDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.apsw_ext.APSWDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.apsw_ext.APSWDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.apsw_ext.APSWDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.apsw_ext.APSWDatabase:\n  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.cockroachdb.CockroachDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.cockroachdb.CockroachDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.cockroachdb.CockroachDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.cockroachdb.CockroachDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.cockroachdb.CockroachDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.cockroachdb.CockroachDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.cockroachdb.CockroachDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.cockroachdb.CockroachDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.cockroachdb.CockroachDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.mysql_ext.MariaDBConnectorDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.mysql_ext.MariaDBConnectorDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.mysql_ext.MariaDBConnectorDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.mysql_ext.MariaDBConnectorDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.mysql_ext.MariaDBConnectorDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.mysql_ext.MariaDBConnectorDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.mysql_ext.MariaDBConnectorDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.mysql_ext.MariaDBConnectorDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.mysql_ext.MariaDBConnectorDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.mysql_ext.MySQLConnectorDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.mysql_ext.MySQLConnectorDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.mysql_ext.MySQLConnectorDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.mysql_ext.MySQLConnectorDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.mysql_ext.MySQLConnectorDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.mysql_ext.MySQLConnectorDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.mysql_ext.MySQLConnectorDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.mysql_ext.MySQLConnectorDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.mysql_ext.MySQLConnectorDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledMySQLDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledMySQLDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.pool.PooledMySQLDatabase, ...):\n\
            \  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.pool.PooledMySQLDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.pool.PooledMySQLDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.pool.PooledMySQLDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.pool.PooledMySQLDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.pool.PooledMySQLDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.pool.PooledMySQLDatabase:\n \
            \ ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledPostgresqlDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledPostgresqlDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.pool.PooledPostgresqlDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.pool.PooledPostgresqlDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.pool.PooledPostgresqlDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.pool.PooledPostgresqlDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.pool.PooledPostgresqlDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.pool.PooledPostgresqlDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.pool.PooledPostgresqlDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledPostgresqlExtDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledPostgresqlExtDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.pool.PooledPostgresqlExtDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.pool.PooledPostgresqlExtDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.pool.PooledPostgresqlExtDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.pool.PooledPostgresqlExtDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.pool.PooledPostgresqlExtDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.pool.PooledPostgresqlExtDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.pool.PooledPostgresqlExtDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledSqliteDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledSqliteDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.pool.PooledSqliteDatabase, ...):\n\
            \  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.pool.PooledSqliteDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.pool.PooledSqliteDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.pool.PooledSqliteDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.pool.PooledSqliteDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.pool.PooledSqliteDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.pool.PooledSqliteDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledSqliteExtDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.pool.PooledSqliteExtDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.pool.PooledSqliteExtDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.pool.PooledSqliteExtDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.pool.PooledSqliteExtDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.pool.PooledSqliteExtDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.pool.PooledSqliteExtDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.pool.PooledSqliteExtDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.pool.PooledSqliteExtDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.postgres_ext.PostgresqlExtDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.postgres_ext.PostgresqlExtDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.postgres_ext.PostgresqlExtDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.postgres_ext.PostgresqlExtDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.postgres_ext.PostgresqlExtDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.postgres_ext.PostgresqlExtDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.postgres_ext.PostgresqlExtDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.postgres_ext.PostgresqlExtDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.postgres_ext.PostgresqlExtDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.psycopg3_ext.Psycopg3Database\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.psycopg3_ext.Psycopg3Database\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.psycopg3_ext.Psycopg3Database,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.psycopg3_ext.Psycopg3Database,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.psycopg3_ext.Psycopg3Database

            ...

            '
        - pattern-inside: '$DB: playhouse.psycopg3_ext.Psycopg3Database = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.psycopg3_ext.Psycopg3Database):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.psycopg3_ext.Psycopg3Database,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.psycopg3_ext.Psycopg3Database:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlcipher_ext.SqlCipherDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlcipher_ext.SqlCipherDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.sqlcipher_ext.SqlCipherDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.sqlcipher_ext.SqlCipherDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.sqlcipher_ext.SqlCipherDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.sqlcipher_ext.SqlCipherDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.sqlcipher_ext.SqlCipherDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.sqlcipher_ext.SqlCipherDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.sqlcipher_ext.SqlCipherDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.sqlcipher_ext.SqlCipherExtDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.sqlcipher_ext.SqlCipherExtDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.sqlcipher_ext.SqlCipherExtDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.sqlcipher_ext.SqlCipherExtDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.sqlcipher_ext.SqlCipherExtDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlite_ext.CSqliteExtDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlite_ext.CSqliteExtDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.sqlite_ext.CSqliteExtDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.sqlite_ext.CSqliteExtDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.sqlite_ext.CSqliteExtDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.sqlite_ext.CSqliteExtDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.sqlite_ext.CSqliteExtDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.sqlite_ext.CSqliteExtDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.sqlite_ext.CSqliteExtDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlite_ext.SqliteExtDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqlite_ext.SqliteExtDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.sqlite_ext.SqliteExtDatabase,\
            \ ...):\n  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.sqlite_ext.SqliteExtDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.sqlite_ext.SqliteExtDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.sqlite_ext.SqliteExtDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.sqlite_ext.SqliteExtDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.sqlite_ext.SqliteExtDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.sqlite_ext.SqliteExtDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqliteq.SqliteQueueDatabase\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.sqliteq.SqliteQueueDatabase\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.sqliteq.SqliteQueueDatabase, ...):\n\
            \  ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.sqliteq.SqliteQueueDatabase,\
            \ ...):\n  ...\n"
        - pattern-inside: '$DB: playhouse.sqliteq.SqliteQueueDatabase

            ...

            '
        - pattern-inside: '$DB: playhouse.sqliteq.SqliteQueueDatabase = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.sqliteq.SqliteQueueDatabase):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.sqliteq.SqliteQueueDatabase,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.sqliteq.SqliteQueueDatabase:\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.flask_utils.FlaskDB\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $DB: playhouse.flask_utils.FlaskDB\
            \ = ...\n  ...\n"
        - pattern-inside: "class $DB(..., playhouse.flask_utils.FlaskDB, ...):\n \
            \ ...\n...\n"
        - pattern-inside: "def $FUN(..., $DB: playhouse.flask_utils.FlaskDB, ...):\n\
            \  ...\n"
        - pattern-inside: '$DB: playhouse.flask_utils.FlaskDB

            ...

            '
        - pattern-inside: '$DB: playhouse.flask_utils.FlaskDB = ...

            ...

            '
        - pattern-inside: "if isinstance($DB, playhouse.flask_utils.FlaskDB):\n  ...\n"
        - pattern-inside: "if isinstance($DB, (..., playhouse.flask_utils.FlaskDB,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($DB) == playhouse.flask_utils.FlaskDB:\n  ...\n"
        - pattern-inside: '$DB = peewee.Database(...)

            ...

            '
        - pattern-inside: '$DB = peewee.SqliteDatabase(...)

            ...

            '
        - pattern-inside: '$DB = peewee.PostgresqlDatabase(...)

            ...

            '
        - pattern-inside: '$DB = peewee.MySQLDatabase(...)

            ...

            '
        - pattern-inside: '$DB = peewee.DatabaseProxy(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.apsw_ext.APSWDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.cockroachdb.CockroachDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.mysql_ext.MariaDBConnectorDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.mysql_ext.MySQLConnectorDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.pool.PooledMySQLDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.pool.PooledPostgresqlDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.pool.PooledPostgresqlExtDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.pool.PooledSqliteDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.pool.PooledSqliteExtDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.postgres_ext.PostgresqlExtDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.psycopg3_ext.Psycopg3Database(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.sqlcipher_ext.SqlCipherDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.sqlcipher_ext.SqlCipherExtDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.sqlite_ext.CSqliteExtDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.sqlite_ext.SqliteExtDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.sqliteq.SqliteQueueDatabase(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.flask_utils.FlaskDB(...)

            ...

            '
        - pattern-inside: '$DB = playhouse.connect(...)

            ...

            '
      - pattern-either:
        - pattern: $DB.cursor(...).execute($SINK, ...)
        - pattern: $DB.cursor(...).execute(..., query=$SINK, ...)
        - pattern: $DB.cursor(...).executemany($SINK, ...)
        - pattern: $DB.cursor(...).executemany(..., query=$SINK, ...)
        - pattern: $DB.cursor(...).executescript($SINK, ...)
        - pattern: $DB.cursor(...).executescript(..., query=$SINK, ...)
        - pattern: $DB.cursor(...).execute_insert($SINK, ...)
        - pattern: $DB.cursor(...).execute_insert(..., query=$SINK, ...)
        - pattern: $DB.cursor(...).execute_fetchall($SINK, ...)
        - pattern: $DB.cursor(...).execute_fetchall(..., query=$SINK, ...)
        - pattern: $CURSOR.execute($SINK, ...)
        - pattern: $CURSOR.execute(..., query=$SINK, ...)
        - pattern: $CURSOR.executemany($SINK, ...)
        - pattern: $CURSOR.executemany(..., query=$SINK, ...)
        - pattern: $CURSOR.executescript($SINK, ...)
        - pattern: $CURSOR.executescript(..., query=$SINK, ...)
        - pattern: $CURSOR.execute_insert($SINK, ...)
        - pattern: $CURSOR.execute_insert(..., query=$SINK, ...)
        - pattern: $CURSOR.execute_fetchall($SINK, ...)
        - pattern: $CURSOR.execute_fetchall(..., query=$SINK, ...)
      - focus-metavariable: $SINK
    - patterns:
      - pattern-either:
        - pattern: "class $CLS:\n  ...\n  $TY: peewee.Model\n  ...\n"
        - pattern: "class $CLS:\n  ...\n  $TY: peewee.Model = ...\n  ...\n"
        - pattern: "class $TY(..., peewee.Model, ...):\n  ...\n...\n"
        - pattern: "def $FUN(..., $TY: peewee.Model, ...):\n  ...\n"
        - pattern: '$TY: peewee.Model

            ...

            '
        - pattern: '$TY: peewee.Model = ...

            ...

            '
        - pattern: "if isinstance($TY, peewee.Model):\n  ...\n"
        - pattern: "if isinstance($TY, (..., peewee.Model, ...)):\n  ...\n"
        - pattern: "if type($TY) == peewee.Model:\n  ...\n"
      - pattern-either:
        - pattern: $TY.raw($SINK, ...)
        - pattern: $TY.raw(..., sql=$SINK, ...)
    - patterns:
      - pattern-either:
        - pattern-inside: "class $CLS:\n  ...\n  $FLASK_DB: playhouse.flask_utils.FlaskDB\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $FLASK_DB: playhouse.flask_utils.FlaskDB\
            \ = ...\n  ...\n"
        - pattern-inside: "class $FLASK_DB(..., playhouse.flask_utils.FlaskDB, ...):\n\
            \  ...\n...\n"
        - pattern-inside: "def $FUN(..., $FLASK_DB: playhouse.flask_utils.FlaskDB,\
            \ ...):\n  ...\n"
        - pattern-inside: '$FLASK_DB: playhouse.flask_utils.FlaskDB

            ...

            '
        - pattern-inside: '$FLASK_DB: playhouse.flask_utils.FlaskDB = ...

            ...

            '
        - pattern-inside: "if isinstance($FLASK_DB, playhouse.flask_utils.FlaskDB):\n\
            \  ...\n"
        - pattern-inside: "if isinstance($FLASK_DB, (..., playhouse.flask_utils.FlaskDB,\
            \ ...)):\n  ...\n"
        - pattern-inside: "if type($FLASK_DB) == playhouse.flask_utils.FlaskDB:\n\
            \  ...\n"
        - pattern-inside: '$FLASK_DB = playhouse.flask_utils.FlaskDB(...)

            ...

            '
        - pattern-inside: '$FLASK_DB = playhouse.flask_utils.FlaskDB(...)

            ...

            '
      - pattern-either:
        - pattern: "class $TY($FLASK_DB.Model):\n    ...\n...\n"
      - pattern-either:
        - pattern: $TY.raw($SINK, ...)
        - pattern: $TY.raw(..., sql=$SINK, ...)
      - focus-metavariable: $SINK
    - patterns:
      - pattern-either:
        - pattern-inside: "class $CLS:\n  ...\n  $INST: playhouse.dataset.DataSet\n\
            \  ...\n"
        - pattern-inside: "class $CLS:\n  ...\n  $INST: playhouse.dataset.DataSet\
            \ = ...\n  ...\n"
        - pattern-inside: "class $INST(..., playhouse.dataset.DataSet, ...):\n  ...\n\
            ...\n"
        - pattern-inside: "def $FUN(..., $INST: playhouse.dataset.DataSet, ...):\n\
            \  ...\n"
        - pattern-inside: '$INST: playhouse.dataset.DataSet

            ...

            '
        - pattern-inside: '$INST: playhouse.dataset.DataSet = ...

            ...

            '
        - pattern-inside: "if isinstance($INST, playhouse.dataset.DataSet):\n  ...\n"
        - pattern-inside: "if isinstance($INST, (..., playhouse.dataset.DataSet, ...)):\n\
            \  ...\n"
        - pattern-inside: "if type($INST) == playhouse.dataset.DataSet:\n  ...\n"
        - pattern-inside: '$INST = playhouse.dataset.DataSet(...)

            ...

            '
        - pattern-inside: '$INST = playhouse.dataset.DataSet(...)

            ...

            '
      - pattern-either:
        - pattern: $INST.query($SINK, ...)
        - pattern: $INST.query(..., sql=$SINK, ...)
      - focus-metavariable: $SINK
    - patterns:
      - pattern-either:
        - pattern: peewee.RawQuery($SINK, ...)
        - pattern: peewee.RawQuery(..., sql=$SINK, ...)
        - pattern: peewee.SQL($SINK, ...)
        - pattern: peewee.SQL(..., sql=$SINK, ...)
        - pattern: peewee.Check($SINK, ...)
        - pattern: peewee.Check(..., sql=$SINK, ...)
      - focus-metavariable: $SINK
pattern-sanitizers:
- patterns:
  - pattern-either:
    - pattern: int(...)
    - pattern: bool(...)
    - pattern: float(...)
    - pattern: complex(...)
    - pattern: oct(...)
    - pattern: hex(...)
    - pattern: bin(...)
    - pattern: round(...)
    - pattern: id(...)
    - pattern: hash(...)
    - pattern: len(...)
    - pattern: type(...)
- patterns:
  - pattern-either:
    - pattern-inside: '$DICT[$KEY]

        ...

        '
    - pattern-inside: '$DICT = { $KEY: $VALUE for ... in ...}

        ...

        '
    - pattern-inside: '$DICT.get($KEY, $DEFAULT)

        ...

        '
    - pattern-inside: '$DICT = { }

        ...

        '
    - pattern-inside: '$DICT = { $KEY: $VALUE, ... }

        ...

        '
    - pattern-inside: '$DICT = dict(...)

        ...

        '
  - pattern-either:
    - pattern: $DICT.clear()
    - pattern: $DICT.len()
- patterns:
  - pattern-either:
    - pattern-inside: '$LIST = [ ... ]

        ...

        '
    - pattern-inside: '$LIST = list(...)

        ...

        '
  - pattern-either:
    - pattern: $LIST.clear()
    - pattern: $LIST.count(...)
    - pattern: $LIST.index(...)
- patterns:
  - pattern-either:
    - pattern-inside: '$SET = { $ITEM, ... }

        ...

        '
    - pattern-inside: '$SET = set(...)

        ...

        '
  - pattern-either:
    - pattern: $SET.len()
    - pattern: $SET.clear()
- patterns:
  - pattern-either:
    - pattern-inside: '$SET = { $ITEM, ... }

        ...

        '
    - pattern-inside: '$SET = { $ITEM for ... in ...}

        ...

        '
    - pattern-inside: '$SET = set(...)

        ...

        '
    - pattern-inside: '$SET = frozenset(...)

        ...

        '
    - pattern-inside: '$OTHERSET = { $ITEM, ... }

        ...

        '
    - pattern-inside: '$OTHERSET = set(...)

        ...

        '
  - pattern-either:
    - pattern: $SET.isdisjoint($OTHERSET)
    - pattern: $SET.issubset($OTHERSET)
    - pattern: $SET < $OTHERSET
    - pattern: $SET <= $OTHERSET
    - pattern: $SET.issuperset($OTHERSET)
    - pattern: $SET > $OTHERSET
    - pattern: $SET >= $OTHERSET
- patterns:
  - pattern-either:
    - pattern-inside: '$TUPLE = ( $ITEM, ... )

        ...

        '
    - pattern-inside: '$TUPLE = $ITEM, ...

        ...

        '
    - pattern-inside: '$TUPLE = tuple(...)

        ...

        '
  - pattern-either:
    - pattern: $TUPLE.len()
- pattern-either:
  - pattern: sqlalchemy.select(...)
  - pattern: sqlalchemy.select(...).$FUNC(...)
  - pattern: sqlalchemy.table(...)
  - pattern: sqlalchemy.table(...).$FUNC(...)
  - pattern: sqlalchemy.bindparam(...)
  - pattern: sqlalchemy.bindparams(...)
  - pattern: $STMT.bindparam(...)
  - pattern: $STMT.bindparams(...)
  - patterns:
    - pattern: $COLUMN.$FUNC(...)
    - pattern-not: $COLUMN.$FUNC(..., autoescape=False, ...)
    - metavariable-regex:
        metavariable: $FUNC
        regex: ^(contains|endswith|like|startswith|icontains|iendswith|ilike|istartswith|not_ilike|not_like|notilike|notlike|regexp_match|regexp_replace)$
