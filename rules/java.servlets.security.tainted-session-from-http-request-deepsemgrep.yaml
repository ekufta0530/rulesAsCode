id: java.servlets.security.tainted-session-from-http-request-deepsemgrep.tainted-session-from-http-request-deepsemgrep
message: Detected input from a HTTPServletRequest going into a session command, like
  `setAttribute`. User input into such a command could lead to an attacker inputting
  malicious code into your session parameters, blurring the line between what's trusted
  and untrusted, and therefore leading to a trust boundary violation. This could lead
  to programmers trusting unvalidated data. Instead, thoroughly sanitize user input
  before passing it into such function calls.
severity: WARNING
metadata:
  likelihood: HIGH
  impact: MEDIUM
  confidence: HIGH
  interfile: true
  category: security
  subcategory:
  - vuln
  cwe:
  - 'CWE-501: Trust Boundary Violation'
  functional-categories:
  - web::source::cookie::Servlet
  - web::source::http-params::Servlet
  - web::source::http-body::Servlet
  - web::source::header::Servlet
  - web::source::url-path-params::Servlet
  - web::sink::session-properties::Servlet
  owasp:
  - A04:2021 - Insecure Design
  references:
  - https://cwe.mitre.org/data/definitions/501.html
  technology:
  - java
  - servlets
  license: Copyright 2023 Semgrep, Inc.
  vulnerability_class:
  - Other
  source: https://semgrep.dev/r/java.servlets.security.tainted-session-from-http-request-deepsemgrep.tainted-session-from-http-request-deepsemgrep
  shortlink: https://sg.run/El0B
  semgrep.dev:
    rule:
      r_id: 40137
      rv_id: 111605
      rule_id: gxU5Ny
      version_id: JdTNvE2
      url: https://semgrep.dev/playground/r/JdTNvE2/java.servlets.security.tainted-session-from-http-request-deepsemgrep.tainted-session-from-http-request-deepsemgrep
      origin: pro_rules
languages:
- java
mode: taint
pattern-sources:
- patterns:
  - pattern-either:
    - pattern: '(HttpServletRequest $REQ).$REQFUNC(...)

        '
    - pattern: "(ServletRequest $REQ).$REQFUNC(...) \n"
  - metavariable-regex:
      metavariable: $REQFUNC
      regex: (getInputStream|getParameter|getParameterMap|getParameterValues|getReader|getCookies|getHeader|getHeaderNames|getHeaders|getPart|getParts|getQueryString)
pattern-sinks:
- pattern: (HttpServletRequest $REQ).getSession().$FUNC(...);
